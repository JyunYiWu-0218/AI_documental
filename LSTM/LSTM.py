import torch
import torch.nn as nn
import torch.nn.functional as F
import torch.optim as optim

torch.manual_seed(1) #CPU 生成隨機種子數，範圍:[-0x8000000000000000, 0xffffffffffffffff]

#設定 pytorch lstm 模型的初始值
lstm = nn.LSTM(100,25,5) #input dim:100, hidden dim:25, LSTM layers:5

#設定輸入值
input_seq = []
for _ in range(50):
    input_seq.append(torch.randn(1, 100)) #生成一個 (Seq) 長度為100, 每個值為 (100*1) 的向量

#隱藏層
hidden_layer = (torch.randn(5, 1, 25), torch.randn(5, 1, 25))
#2層的 (hidden_layer)，每層為(5*10*25)

for i in input_seq:
    # 每一次遍歷後，隱藏層都包含隱藏狀態(hidden state)
    out, hidden = lstm(i.view(1, 1, -1), hidden_layer)
"""
i.view(1, 1, -1)
tensor([[[-0.7657,  1.5624,  0.9459,  0.1284,  0.7037, -1.3942, -0.7121,
          -0.2117,  0.1253, -0.2701, -0.5471,  0.9857,  1.0711, -0.2057,
           1.6514,  0.8069, -0.5286, -0.3792, -0.3940,  0.8186, -0.2419,
           0.1416,  1.3305,  1.3610, -1.0281,  0.6323, -0.5857,  0.4105,
          -1.4267, -0.5056, -2.2356, -1.8287, -0.9996, -0.0252, -0.6477,
           0.2181,  1.3265,  2.0510, -0.1282,  0.6244, -1.5601, -0.2249,
          -0.3792, -1.1244, -0.2704, -0.4815, -0.1509,  0.3518, -0.0042,
          -0.7313,  0.0710, -0.0518, -0.1631,  0.1912, -1.1375,  0.3883,
           1.0545, -0.0377,  0.7087,  2.1830,  1.2919,  0.6462,  1.4275,
          -0.8807, -0.8408,  2.5964, -1.0249, -0.4589,  0.7009,  0.5784,
          -0.9743,  2.3541, -0.4629,  0.4228, -0.8245, -0.7649,  0.8905,
           0.8689, -1.1231,  0.0672,  0.3622,  2.1144, -0.3239, -0.7497,
          -0.6408,  0.7961, -1.0574,  0.2862, -0.4171, -0.5506, -0.9039,
          -0.5047, -0.8235,  0.0612,  0.3698,  0.2351, -0.3291,  0.4522,
          -0.3373,  0.4205]]])
tensor([[[ 0.3024, -1.2938, -0.0243,  0.8397,  3.3826, -0.7156, -2.3834,
           0.6201, -0.2759,  1.4780,  0.6302,  1.2493, -0.2940, -1.9892,
          -2.2348, -0.0098,  0.8091, -0.0145, -0.1765,  0.6681,  0.0683,
           1.0676, -0.3563, -0.7455,  0.2914, -0.7780,  0.8398, -0.4582,
           1.4425, -0.9393,  1.1161, -1.3754, -0.6480,  0.1093,  2.0272,
           0.8159,  0.4598,  1.3029, -0.5784,  1.4751,  1.0348, -1.0718,
           0.0920, -1.3869,  1.1327,  0.3079, -0.4252, -0.1122, -0.9472,
          -1.3877,  1.8519,  0.7081,  0.3002,  0.2798,  1.3538, -0.7298,
          -0.0889,  2.5358, -0.1322, -0.7016,  0.4519,  0.5510,  1.6133,
          -1.3342, -0.1576,  0.9271, -0.5476,  0.5411, -0.4416,  0.0085,
          -0.3892, -1.1349, -0.8448,  0.4379, -0.3311, -0.1674,  1.1435,
           0.3698, -0.8422,  0.6754,  0.7181,  1.2660, -0.3613,  0.3210,
          -0.6423, -0.2766,  0.7237,  0.1718, -0.1838,  1.0756,  0.1369,
           2.6017,  0.5574, -0.8611,  0.6990, -1.5805, -1.3485, -0.8558,
          -0.4822,  0.1943]]])
tensor([[[ 0.8822,  1.5946, -1.0945, -1.0437, -1.7074,  0.1551,  1.4457,
          -1.4319, -0.2558, -0.4757,  1.2479, -0.0296,  0.5239, -2.3726,
          -0.0461, -0.1310,  0.2639, -0.3786, -1.0090,  0.8190,  0.7468,
          -0.5874, -0.0963, -0.7011, -1.2802,  1.0360,  0.4112,  0.1419,
           0.5311,  0.4200, -1.0471,  0.1328,  0.6678, -0.5165,  1.5028,
          -0.7185,  1.5498, -1.2602, -0.0569, -1.4298,  0.9316,  1.8586,
           0.6027,  1.4680,  0.3036, -1.2309,  0.9895,  0.5704,  2.2268,
          -1.3512, -0.9806,  0.7728,  0.5297, -0.5356, -0.1317, -0.4619,
          -0.6327, -0.0474, -0.1729,  0.2701, -0.5130,  0.8981, -0.1496,
           0.1565, -0.9840, -1.1565, -0.9876, -0.9949,  1.1215,  0.3230,
          -0.0395,  0.0832, -0.6310, -0.1715, -0.0427,  0.2269,  1.4788,
           0.0616, -0.0509, -1.3033, -0.6835, -0.5867, -0.8065,  1.4975,
           0.7176, -1.2869, -0.4304, -0.6461,  1.0047,  0.1560,  1.4759,
           1.0045, -1.4530,  0.7145,  1.1779,  0.2058,  1.3878,  0.4951,
           1.4094, -0.0457]]])
......
"""

print(out)
"""
tensor([[[ 0.4029,  0.0612,  0.0151,  0.0528,  0.2972, -0.1193, -0.1582,
          -0.0486,  0.1600, -0.2683, -0.0219, -0.0729,  0.1927, -0.0206,
          -0.2810,  0.2959, -0.1745, -0.0802,  0.0118, -0.3059,  0.2874,
           0.3158, -0.0636, -0.0261,  0.2575]]],
       grad_fn=<MkldnnRnnLayerBackward0>)
"""
print(hidden)
"""
(tensor([[[-0.2821, -0.0452,  0.0703,  0.2209,  0.0023,  0.0543,  0.0834,
           0.2591, -0.0398, -0.1389, -0.1573, -0.0725, -0.1306,  0.1267,
           0.5107, -0.2697,  0.2200, -0.0773, -0.1019,  0.0982,  0.4479,
          -0.2188,  0.2459,  0.1946,  0.0200]],

        [[-0.0418, -0.3129, -0.4814, -0.2861, -0.1144,  0.0856, -0.0473,
          -0.0648, -0.3192,  0.3728,  0.1768, -0.0076,  0.4181, -0.0353,
          -0.0468, -0.2971,  0.0481, -0.1534,  0.6254, -0.1847,  0.0292,
          -0.1074,  0.2650, -0.0246, -0.3615]],

        [[ 0.1183, -0.0727,  0.3834, -0.1280,  0.2750, -0.0495,  0.0236,
           0.1871,  0.0445, -0.1482, -0.4565,  0.0205, -0.2410, -0.1463,
           0.0281,  0.0027,  0.2914, -0.3660,  0.1741,  0.0708,  0.0063,
           0.4112, -0.1226,  0.1396, -0.0383]],

        [[ 0.2147, -0.1001, -0.3465,  0.4996,  0.3195, -0.3015, -0.1076,
           0.0991,  0.1200,  0.0544,  0.2044, -0.0041,  0.2964,  0.0692,
          -0.3551, -0.0942, -0.1298, -0.4959, -0.0431, -0.0120, -0.3516,
          -0.3211, -0.5257, -0.1366,  0.2312]],

        [[ 0.4029,  0.0612,  0.0151,  0.0528,  0.2972, -0.1193, -0.1582,
          -0.0486,  0.1600, -0.2683, -0.0219, -0.0729,  0.1927, -0.0206,
          -0.2810,  0.2959, -0.1745, -0.0802,  0.0118, -0.3059,  0.2874,
           0.3158, -0.0636, -0.0261,  0.2575]]], grad_fn=<StackBackward0>),
        tensor([[[-1.0174, -0.1109,  0.1612,  1.1204,  0.0092,  0.1939,  0.3931,
           0.2938, -0.0970, -0.2995, -1.9449, -0.2560, -0.1871,  0.4885,
           1.3478, -0.6971,  0.4431, -0.6525, -0.1582,  0.1901,  0.6651,
          -0.8286,  0.4433,  1.3499,  0.2166]],

        [[-0.1348, -0.6910, -0.8536, -0.9322, -0.1709,  0.1826, -0.1089,
          -0.0769, -0.5672,  1.0553,  0.3263, -0.0230,  1.4314, -0.0564,
          -0.1162, -0.7415,  0.1064, -0.4088,  0.9419, -0.3302,  0.0612,
          -0.2196,  0.6267, -0.0712, -0.8529]],

        [[ 0.4495, -0.1943,  0.7304, -0.3317,  1.9088, -0.2141,  0.0484,
           0.4640,  0.1174, -0.3899, -1.5707,  0.0561, -0.5379, -0.4529,
           0.0493,  0.0108,  1.1148, -1.0590,  0.6591,  0.3688,  0.0222,
           0.8537, -0.3858,  0.5013, -0.0619]],

        [[ 0.5232, -0.2766, -0.5488,  0.9287,  0.4583, -0.7058, -0.1479,
           1.1112,  0.1823,  0.0786,  0.5662, -0.0055,  0.4377,  0.0981,
          -0.5042, -0.3022, -0.1680, -2.0928, -0.1728, -0.0638, -0.5929,
          -0.4778, -0.7027, -0.4297,  0.5604]],

        [[ 0.9388,  0.1283,  0.0553,  0.0914,  0.4556, -0.3813, -0.2888,
          -0.1275,  0.2559, -0.4373, -0.0622, -0.1103,  0.3511, -0.0330,
          -0.9152,  0.8955, -0.4804, -0.1541,  0.0220, -1.4067,  0.5946,
           0.8428, -0.1509, -0.1270,  0.4169]]], grad_fn=<StackBackward0>))
"""



